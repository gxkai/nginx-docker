(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b24eb"],{"240c":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"h-full"},[a("div",{staticClass:"bg-white w-full mt-5 px-10 py-10"},[a("div",{staticClass:"flex justify-between w-full"},[a("div",[a("el-button",{attrs:{type:"success",round:"",icon:"el-icon-plus"},on:{click:t.create}},[t._v("添加部门")])],1)]),t._v(" "),a("vxe-table",{ref:"xTable",staticClass:"mt-8",attrs:{border:"",resizable:"",loading:t.loading,"start-index":(t.tablePage.currentPage-1)*t.tablePage.pageSize,"pager-config":t.tablePage,data:t.tableData}},[a("vxe-table-column",{attrs:{field:"title",title:"部门名称"}}),t._v(" "),a("vxe-table-column",{attrs:{field:"users_count",title:"人数"}}),t._v(" "),a("vxe-table-column",{attrs:{title:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("div",[a("el-button",{attrs:{size:"small",circle:"",icon:"icon-zhongzhimima1"},on:{click:function(e){return t.deleteEvent(i)}}}),t._v(" "),a("el-button",{attrs:{circle:"",type:"success",plain:"",icon:"el-icon-edit"},on:{click:function(e){return t.editEvent(i)}}})],1)]}}])})],1),t._v(" "),a("vxe-pager",{attrs:{loading:t.loading,"current-page":t.tablePage.currentPage,"page-size":t.tablePage.pageSize,total:t.tablePage.total,layouts:["PrevPage","JumpNumber","NextPage","FullJump","Sizes","Total"]},on:{"page-change":t.handlePageChange}})],1),t._v(" "),a("vxe-modal",{attrs:{width:"600","show-header":!0,title:t.actionTip[t.action]+"部门","show-footer":!0},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px","label-position":"top"}},[a("div",{},[a("div",{staticClass:"flex"},[a("el-form-item",{staticClass:"flex-1",attrs:{label:"部门",prop:"title",rules:[{required:!0,message:"部门不能为空",trigger:"blur"}]}},[a("el-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1)],1)])])],t._v(" "),a("template",{slot:"footer"},[a("div",{staticClass:"flex justify-end"},[a("el-button",{attrs:{round:""},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),a("div",{staticClass:"w-2"}),t._v(" "),a("el-button",{attrs:{type:"success",round:""},on:{click:t.confirm}},[t._v("确认")])],1)])],2)],1)},n=[],s=(a("ac6a"),a("456d"),a("96cf"),a("3b8d")),r={name:"Department",components:{},mixins:[],extends:{},filters:{},provide:{},inject:[],props:{},computed:{},watch:{tabIndex:function(t,e){this.findList()}},data:function(){return{loading:!1,editId:0,modal:!1,action:"add",actionTip:{add:"添加",edit:"修改"},company_id:"",tablePage:{total:0,currentPage:1,pageSize:10},tableData:[],dueDates:[],params:{customer:"",startDate:"",endDate:"",product:"",dueDate:""},form:{title:""},roles:[{id:1,name:"管理员"},{id:2,name:"总监"},{id:3,name:"渠道总监"},{id:4,name:"行政客服"},{id:5,name:"业务经理"},{id:6,name:"总经理"}]}},created:function(){this.findList(),this.company_id=this.$store.state.user.user.company_id},methods:{findList:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,this.$request.get("/api/department",{params:{page:this.tablePage.currentPage,limit:this.tablePage.pageSize,customer:this.params.customer}});case 4:e=t.sent,a=e.data,i=a.total,n=a.data,this.tableData=n,this.tablePage.total=i;case 10:return t.prev=10,this.loading=!1,t.finish(10);case 13:case"end":return t.stop()}}),t,this,[[0,,10,13]])})));function e(){return t.apply(this,arguments)}return e}(),searchEvent:function(){this.tablePage.currentPage=1,this.findList()},handlePageChange:function(t){var e=t.currentPage,a=t.pageSize;this.tablePage.currentPage=e,this.tablePage.pageSize=a,this.findList()},removeEvent:function(t){this.$XModal.confirm("您确定要移除保护吗？").then()},deleteEvent:function(t){var e=this;this.$confirm("确定删除此部门?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,e.$request.delete("/api/department/".concat(t.id)).then((function(t){e.$message({message:t,type:"success"}),e.loading=!1,e.findList()}))})).catch((function(){e.$message({message:"删除失败",type:"error"}),e.loading=!1}))},editEvent:function(t){this.action="edit",this.form=_.pick(t,Object.keys(this.form)),this.editId=t.id,this.modal=!0},create:function(){this.modal=!0,this.action="add"},cancel:function(){this.modal=!1,this.$refs["form"].resetFields()},exportCsvEvent:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,this.$request.get("/user/all",{params:{customer:this.params.customer}});case 4:e=t.sent,a=e.data,this.$refs.xTable.exportCsv({filename:"人员信息.csv",original:!0,isHeader:!0,data:a});case 7:return t.prev=7,this.loading=!1,t.finish(7);case 10:case"end":return t.stop()}}),t,this,[[0,,7,10]])})));function e(){return t.apply(this,arguments)}return e}(),confirm:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$validate(this,"form");case 2:if(t.prev=2,"edit"!==this.action){t.next=8;break}return t.next=6,this.$request.patch("/api/department/".concat(this.editId),{title:this.forms.title,company_id:this.company_id});case 6:t.next=10;break;case 8:return t.next=10,this.$request.post("/api/department",{title:this.form.title,company_id:this.company_id});case 10:return t.prev=10,this.$message({message:this.actionTip[this.action]+"成功！",type:"success"}),this.findList(),this.cancel(),t.finish(10);case 15:case"end":return t.stop()}}),t,this,[[2,,10,15]])})));function e(){return t.apply(this,arguments)}return e}()}},o=r,c=a("2877"),l=Object(c["a"])(o,i,n,!1,null,"39eaf948",null);e["default"]=l.exports}}]);