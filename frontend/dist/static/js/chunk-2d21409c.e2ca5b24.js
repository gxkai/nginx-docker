(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21409c"],{aedf:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"h-full"},[a("div",{staticClass:"bg-white w-full mt-5 px-10 py-10"},[a("div",{staticClass:"flex justify-between w-full"},[a("div",{staticClass:"flex"},[a("el-button",{attrs:{type:"success",round:"",icon:"el-icon-plus"},on:{click:e.addCustomer}},[e._v("添加客户")])],1),e._v(" "),a("div",{staticClass:"flex"},[a("el-input",{attrs:{placeholder:"请输入客户名称/业务员"},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}}),e._v(" "),a("el-select",{staticClass:"ml-2",attrs:{placeholder:"请选择部门"},model:{value:e.params.department_id,callback:function(t){e.$set(e.params,"department_id",t)},expression:"params.department_id"}},e._l(e.departments,(function(e){return a("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1),e._v(" "),a("el-button",{staticClass:"ml-5",attrs:{type:"success",round:""},on:{click:e.searchEvent}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"small",round:""},on:{click:e.exportCsvEvent}},[e._v("导出")])],1)]),e._v(" "),a("vxe-table",{ref:"xTable",staticClass:"mt-8",attrs:{border:"",resizable:"",loading:e.loading,"start-index":(e.tablePage.currentPage-1)*e.tablePage.pageSize,"pager-config":e.tablePage,data:e.tableData}},[a("vxe-table-column",{attrs:{field:"name",title:"客户名称"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("div",[e._v("\n            "+e._s(r.name)+"\n          ")])]}}])}),e._v(" "),a("vxe-table-column",{attrs:{field:"contact",title:"联系人"}}),e._v(" "),a("vxe-table-column",{attrs:{field:"phone",title:"手机号"}}),e._v(" "),a("vxe-table-column",{attrs:{field:"address",title:"地址"}})],1),e._v(" "),a("vxe-pager",{attrs:{loading:e.loading,"current-page":e.tablePage.currentPage,"page-size":e.tablePage.pageSize,total:e.tablePage.total,layouts:["PrevPage","JumpNumber","NextPage","FullJump","Sizes","Total"]},on:{"page-change":e.handlePageChange}})],1),e._v(" "),a("vxe-modal",{attrs:{width:"600","show-header":!0,title:"添加客户","show-footer":!0},model:{value:e.adding,callback:function(t){e.adding=t},expression:"adding"}},[[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px","label-position":"top"}},[a("div",{},[a("div",{staticClass:"flex justify-between items-center"},[a("el-form-item",{attrs:{label:"客户名称",prop:"name",rules:[{required:!0,message:"请输入客户名称",trigger:"blur"}]}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),e._v(" "),a("div",{staticClass:"flex justify-between"},[a("el-form-item",{staticClass:"flex-1",attrs:{label:"联系人",prop:"contact",rules:[{required:!0,message:"请输入联系人",trigger:"blur"}]}},[a("el-input",{model:{value:e.form.contact,callback:function(t){e.$set(e.form,"contact",t)},expression:"form.contact"}})],1),e._v(" "),a("div",{staticClass:"w-2"}),e._v(" "),a("el-form-item",{staticClass:"flex-1",attrs:{label:"手机号码",prop:"phone",rules:[{required:!0,message:"请输入手机号码",trigger:"blur"}]}},[a("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"地址",prop:"address",rules:[{required:!0,message:"请输入地址",trigger:"blur"}]}},[a("el-input",{model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"业务员",prop:"user_id",rules:[{required:!0,message:"请选择业务员",trigger:"blur"}]}},[a("div",{staticClass:"flex"},[a("el-select",{staticClass:"flex-1",attrs:{placeholder:"请选择部门"},on:{change:e.changeDepartment},model:{value:e.form.department_id,callback:function(t){e.$set(e.form,"department_id",t)},expression:"form.department_id"}},e._l(e.departments,(function(e){return a("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1),e._v(" "),a("div",{staticClass:"w-2"}),e._v(" "),a("el-select",{staticClass:"flex-1",attrs:{placeholder:"请选择业务员"},model:{value:e.form.user_id,callback:function(t){e.$set(e.form,"user_id",t)},expression:"form.user_id"}},e._l(e.users,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)]),e._v(" "),a("el-form-item",{attrs:{label:"备注说明"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.comments,callback:function(t){e.$set(e.form,"comments",t)},expression:"form.comments"}})],1)],1)])],e._v(" "),a("template",{slot:"footer"},[a("div",{staticClass:"flex justify-end"},[a("el-button",{attrs:{round:""},on:{click:e.cancelAdding}},[e._v("取消")]),e._v(" "),a("div",{staticClass:"w-2"}),e._v(" "),a("el-button",{attrs:{type:"success",round:"",loading:e.form.isLoading},on:{click:e.confirmAdding}},[e._v("确认")])],1)])],2)],1)},n=[],s=(a("7f7f"),a("96cf"),a("3b8d")),i={name:"Customer",components:{},mixins:[],extends:{},filters:{},provide:{},inject:[],props:{},computed:{},watch:{},data:function(){return{loading:!1,adding:!1,tablePage:{total:0,currentPage:1,pageSize:10},tableData:[],dueDates:[],params:{name:"",department_id:""},departments:[],users:[],form:{name:"",contact:"",phone:"",address:"",comments:""}}},beforeRouteEnter:function(e,t,a){a((function(e){}))},beforeRouteUpdate:function(e,t,a){a()},beforeRouteLeave:function(e,t,a){a()},beforeCreate:function(){},created:function(){this.findDepartments(),this.findList()},beforeMount:function(){},mounted:function(){},beforeUpdate:function(){},updated:function(){},activated:function(){},deactivated:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{findList:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.loading=!0,e.next=4,this.$request.get("/api/customer",{params:Object.assign({page:this.tablePage.currentPage,limit:this.tablePage.pageSize},this.params)});case 4:t=e.sent,a=t.data,r=a.total,n=a.data,this.tableData=n,this.tablePage.total=r;case 10:return e.prev=10,this.loading=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[0,,10,13]])})));function t(){return e.apply(this,arguments)}return t}(),searchEvent:function(){this.tablePage.currentPage=1,this.findList()},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.tablePage.currentPage=t,this.tablePage.pageSize=a,this.findList()},exportCsvEvent:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.loading=!0,e.next=4,this.$request.get("/api/customer",{params:this.params});case 4:t=e.sent,a=t.data,this.$refs.xTable.exportCsv({filename:"客户信息.csv",original:!0,isHeader:!0,data:a});case 7:return e.prev=7,this.loading=!1,e.finish(7);case 10:case"end":return e.stop()}}),e,this,[[0,,7,10]])})));function t(){return e.apply(this,arguments)}return t}(),cancelAdding:function(){this.adding=!1},confirmAdding:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,r,n,s,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$validate(this,"form");case 2:return e.prev=2,this.form.isLoading=!0,t=this.form,a=t.name,r=t.contact,n=t.phone,s=t.user_id,i=t.comments,o=t.address,e.next=7,this.$request.post("/api/customer",{name:a,contact:r,phone:n,user_id:s,comments:i,address:o});case 7:this.adding=!1,this.findList();case 9:return e.prev=9,this.form.isLoading=!1,e.finish(9);case 12:case"end":return e.stop()}}),e,this,[[2,,9,12]])})));function t(){return e.apply(this,arguments)}return t}(),addCustomer:function(){this.adding=!0},findDepartments:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$request.get("/api/department");case 2:t=e.sent,a=t.data,this.departments=a;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),changeDepartment:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$request.get("/api/user",{params:{department_id:this.form.department_id}});case 2:t=e.sent,a=t.data,this.users=a;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},o=i,l=a("2877"),c=Object(l["a"])(o,r,n,!1,null,"a2281be0",null);t["default"]=c.exports}}]);