(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21060b"],{b843:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"h-full"},[a("div",{staticClass:"bg-white w-full mt-5 px-10 py-10"},[a("div",{staticClass:"flex justify-between w-full"},[a("div",[a("el-button",{attrs:{type:"success",round:"",icon:"el-icon-plus"},on:{click:e.create}},[e._v("添加人员")])],1),e._v(" "),a("div",{staticClass:"flex"},[a("el-input",{attrs:{placeholder:"请输入业务员名称"},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}}),e._v(" "),a("div",{staticClass:"w-2"}),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.params.department_id,callback:function(t){e.$set(e.params,"department_id",t)},expression:"params.department_id"}},e._l(e.department,(function(e){return a("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1),e._v(" "),a("div",{staticClass:"w-2"}),e._v(" "),a("el-button",{attrs:{type:"success",round:""},on:{click:e.searchEvent}},[e._v("搜索")]),e._v(" "),a("div",{staticClass:"w-2"}),e._v(" "),a("el-button",{attrs:{size:"small",round:""},on:{click:e.exportCsvEvent}},[e._v("导出")])],1)]),e._v(" "),a("vxe-table",{ref:"xTable",staticClass:"mt-8",attrs:{border:"",resizable:"",loading:e.loading,"start-index":(e.tablePage.currentPage-1)*e.tablePage.pageSize,"pager-config":e.tablePage,data:e.tableData}},[a("vxe-table-column",{attrs:{field:"name",title:"姓名"}}),e._v(" "),a("vxe-table-column",{attrs:{field:"department.title",title:"部门"}}),e._v(" "),a("vxe-table-column",{attrs:{field:"roles[0].title",title:"角色"}}),e._v(" "),a("vxe-table-column",{attrs:{field:"phone",title:"手机号码"}}),e._v(" "),a("vxe-table-column",{attrs:{field:"email",title:"邮箱"}}),e._v(" "),a("vxe-table-column",{attrs:{title:"状态",field:"status"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[0===i.status?a("div",{staticClass:"text-red-500"},[e._v("离职")]):e._e(),e._v(" "),1===i.status?a("div",[e._v("在职")]):e._e()]}}])}),e._v(" "),a("vxe-table-column",{attrs:{title:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[a("el-button",{attrs:{size:"small",circle:"",icon:"icon-zhongzhimima1"},on:{click:function(t){return e.resetPassword(i)}}}),e._v(" "),a("el-button",{attrs:{circle:"",type:"success",plain:"",icon:"el-icon-edit"},on:{click:function(t){return e.editEvent(i)}}})],1)]}}])})],1),e._v(" "),a("vxe-pager",{attrs:{loading:e.loading,"current-page":e.tablePage.currentPage,"page-size":e.tablePage.pageSize,total:e.tablePage.total,layouts:["PrevPage","JumpNumber","NextPage","FullJump","Sizes","Total"]},on:{"page-change":e.handlePageChange}})],1),e._v(" "),a("vxe-modal",{attrs:{width:"600","show-header":!0,title:e.actionTip[e.action]+"人员","show-footer":!0},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px","label-position":"top"}},[a("div",{staticClass:"h-auto"},[a("div",{staticClass:"flex justify-between items-center"},[a("el-form-item",{staticClass:"flex-1",attrs:{label:"姓名",prop:"name",rules:[{required:!0,message:"姓名不能为空",trigger:"blur"}]}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("div",{staticClass:"w-2"}),e._v(" "),a("el-form-item",{staticClass:"flex-1",attrs:{label:"手机号码",prop:"phone",rules:[{required:!0,message:"手机号码不能为空",trigger:"blur"}]}},[a("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1)],1),e._v(" "),a("div",{staticClass:"flex"},[a("el-form-item",{staticClass:"flex-1",attrs:{label:"邮箱",prop:"email",rules:[{required:!0,message:"邮箱不能为空",trigger:"blur"}]}},[a("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),a("div",{staticClass:"w-2"}),e._v(" "),"add"===e.action?a("el-form-item",{staticClass:"flex-1",attrs:{label:"登陆密码",prop:"password",rules:[{required:!0,message:"密码不能为空",trigger:"blur"}]}},[a("el-input",{model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1):e._e()],1),e._v(" "),a("div",{staticClass:"flex"},[a("el-form-item",{staticClass:"flex-1",attrs:{label:"部门",prop:"department_id",rules:[{required:!0,message:"部门不能为空",trigger:"blur"}]}},[a("el-select",{staticClass:"w-full",attrs:{placeholder:"请选择"},model:{value:e.form.department_id,callback:function(t){e.$set(e.form,"department_id",t)},expression:"form.department_id"}},e._l(e.department,(function(e){return a("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1)],1),e._v(" "),a("div",{staticClass:"w-2"}),e._v(" "),a("el-form-item",{staticClass:"flex-1",attrs:{label:"级别",prop:"level_id",rules:[{required:!0,message:"级别不能为空",trigger:"blur"}]}},[a("el-select",{staticClass:"w-full",attrs:{placeholder:"请选择"},model:{value:e.form.level_id,callback:function(t){e.$set(e.form,"level_id",t)},expression:"form.level_id"}},e._l(e.levels,(function(e){return a("el-option",{key:e.id,attrs:{label:e.title,value:e.level}})})),1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"角色",prop:"role_id",rules:[{required:!0,message:"请选择角色",trigger:"blur"}]}},[a("el-radio-group",{model:{value:e.form.role_id,callback:function(t){e.$set(e.form,"role_id",t)},expression:"form.role_id"}},e._l(e.roles,(function(t){return a("el-radio",{key:t.id,attrs:{value:t.id,label:t.id}},[e._v(e._s(t.title)+"\n              ")])})),1)],1)],1)])],e._v(" "),a("template",{slot:"footer"},[a("div",{staticClass:"flex justify-end"},[a("el-button",{attrs:{round:""},on:{click:e.cancel}},[e._v("取消")]),e._v(" "),a("div",{staticClass:"w-2"}),e._v(" "),a("el-button",{attrs:{type:"success",round:""},on:{click:e.confirm}},[e._v("确认")])],1)])],2)],1)},s=[],r=(a("ac6a"),a("456d"),a("7f7f"),a("96cf"),a("3b8d")),n={name:"User1",components:{},mixins:[],extends:{},filters:{},provide:{},inject:[],props:{},computed:{},watch:{tabIndex:function(e,t){this.findList()}},data:function(){return{loading:!1,editId:0,modal:!1,action:"add",actionTip:{add:"添加",edit:"修改"},tablePage:{total:0,currentPage:1,pageSize:10},tableData:[],dueDates:[],department:[],radio:"",params:{name:"",department_id:""},form:{name:"",phone:"",email:"",department_id:"",password:"",role_id:"",level_id:""},roles:[],levels:[{id:1,level:1,title:"员工"},{id:2,level:2,title:"经理"},{id:3,level:3,title:"总监"}]}},created:function(){this.findDepartmentList()},mounted:function(){this.findList()},methods:{findList:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.loading=!0,e.next=4,this.$request.get("/api/user",{params:{page:this.tablePage.currentPage,limit:this.tablePage.pageSize,name:this.params.name,department_id:this.params.department_id}});case 4:t=e.sent,a=t.data,i=a.total,s=a.data,this.tableData=s,this.tablePage.total=i;case 10:return e.prev=10,this.loading=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[0,,10,13]])})));function t(){return e.apply(this,arguments)}return t}(),searchEvent:function(){this.tablePage.currentPage=1,this.findList()},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.tablePage.currentPage=t,this.tablePage.pageSize=a,this.findList()},resetPassword:function(e){var t=this;console.log(e),this.$confirm("确定重置密码吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,t.$request.post("/api/resetpwd",{user_id:e.id}).then((function(e){console.log(e),t.$message({message:e.message,type:"success"}),t.loading=!1,t.findList()}))})).catch((function(){t.loading=!1}))},editEvent:function(e){this.action="edit",this.form=_.pick(e,Object.keys(this.form)),this.$set(this.form,"role_id",e.roles[0].id),this.editId=e.id,this.modal=!0},create:function(){this.modal=!0,this.action="add"},cancel:function(){this.modal=!1,this.$refs["form"].resetFields()},exportCsvEvent:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.loading=!0,e.next=4,this.$request.get("/api/user",{params:{name:this.params.name,department_id:this.params.department_id}});case 4:t=e.sent,a=t.data,this.$refs.xTable.exportCsv({filename:"人员信息.csv",original:!0,isHeader:!0,data:a});case 7:return e.prev=7,this.loading=!1,e.finish(7);case 10:case"end":return e.stop()}}),e,this,[[0,,7,10]])})));function t(){return e.apply(this,arguments)}return t}(),confirm:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$validate(this,"form");case 2:if(e.prev=2,"edit"!==this.action){e.next=8;break}return e.next=6,this.$request.patch("/api/user/".concat(this.editId),this.form);case 6:e.next=11;break;case 8:return this.form.company_id=this.$store.state.user.user.company_id,e.next=11,this.$request.post("/api/user",this.form);case 11:return e.prev=11,this.$message({message:this.actionTip[this.action]+"成功！",type:"success"}),this.findList(),this.cancel(),e.finish(11);case 16:case"end":return e.stop()}}),e,this,[[2,,11,16]])})));function t(){return e.apply(this,arguments)}return t}(),findDepartmentList:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$request.get("/api/role");case 2:return t=e.sent,a=t.data,this.roles=a,e.next=7,this.$request.get("/api/department");case 7:i=e.sent,s=i.data,this.department=s;case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},l=n,o=a("2877"),c=Object(o["a"])(l,i,s,!1,null,"d25cad98",null);t["default"]=c.exports}}]);